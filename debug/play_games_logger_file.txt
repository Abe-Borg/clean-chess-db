2025-02-06 19:54:28,321 - CRITICAL - db cleanup interrupted because of:  invalid san: ''
2025-02-06 19:54:28,323 - CRITICAL - multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "C:\Program Files\Python312\Lib\multiprocessing\pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\multiprocessing\pool.py", line 51, in starmapstar
    return list(itertools.starmap(args[0], args[1]))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\training\training_functions.py", line 42, in worker_play_games
    result = play_one_game(game_number, chess_data, w_agent, b_agent, environ)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\training\training_functions.py", line 71, in play_one_game
    result = handle_agent_turn(
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\training\training_functions.py", line 103, in handle_agent_turn
    apply_move_and_update_state(chess_move, environ)
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\training\training_functions.py", line 109, in apply_move_and_update_state
    environ.board.push_san(chess_move)
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\venv\Lib\site-packages\chess\__init__.py", line 3105, in push_san
    move = self.parse_san(san)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\venv\Lib\site-packages\chess\__init__.py", line 3037, in parse_san
    raise InvalidMoveError(f"invalid san: {san!r}")
chess.InvalidMoveError: invalid san: ''
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\main\play_games.py", line 33, in <module>
    corrupted_games = play_games(chess_data)
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\training\training_functions.py", line 23, in play_games
    return process_games_in_parallel(game_indices, worker_play_games, chess_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Abrah\Dropbox\PC (3)\Desktop\clean-chess-db\training\training_functions.py", line 30, in process_games_in_parallel
    results = pool.starmap(worker_function, [(chunk, *args) for chunk in chunks])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\multiprocessing\pool.py", line 375, in starmap
    return self._map_async(func, iterable, starmapstar, chunksize).get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\multiprocessing\pool.py", line 774, in get
    raise self._value
chess.InvalidMoveError: invalid san: ''

